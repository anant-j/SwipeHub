<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Swipeflix</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/5.0.0/normalize.min.css">
    <link rel='stylesheet' href='https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css'>
    <link rel="stylesheet" href="./style.css">

</head>

<body>
    <div id="loading" class="loader"></div>
    <div id="initialButtons">
        <button onclick="joiningPage()">
            Join Session
        </button>
        <button onclick="createSessionPage()">
            Create Session
        </button>
    </div>
    <div id="joinSession">
        <input id="sessionId"></input>
        <button onclick="joinSession()">Join Session</button>
    </div>
    <div id="createSessionPage">
        <div id="multiButtonGroup">
            <h2>Please select categories:</h2>
            <button id="28" class="genreButton">Action</button>
            <button id="12" class="genreButton">Adventure</button>
            <button id="16" class="genreButton">Animation</button>
            <button id="35" class="genreButton">Comedy</button>
            <button id="80" class="genreButton">Crime</button>
            <button id="99" class="genreButton">Documentary</button>
            <button id="18" class="genreButton">Drama</button>
            <button id="10751" class="genreButton">Family</button>
            <button id="14" class="genreButton">Fantasy</button>
            <button id="36" class="genreButton">History</button>
            <button id="27" class="genreButton">Horror</button>
            <button id="10402" class="genreButton">Music</button>
            <button id="9648" class="genreButton">Mystery</button>
            <button id="10749" class="genreButton">Romance</button>
            <button id="878" class="genreButton">Science Fiction</button>
            <button id="10770" class="genreButton">TV Movie</button>
            <button id="53" class="genreButton">Thriller</button>
            <button id="10752" class="genreButton">War</button>
            <button id="37" class="genreButton">Western</button>
        </div>
    </div>
    <style>
        #joinSession {
            display: none
        }

        #createSessionPage {
            display: none
        }
    </style>
</body>
<script>
    store = window.localStorage;
    function joiningPage() {
        document.getElementById("initialButtons").style.display = "none";
        document.getElementById("joinSession").style.display = "block";
    }
    function joinSession() {
        const input_id = document.getElementById("sessionId").value;
        document.getElementById("loading").style.display = "block";

        var xhr = new XMLHttpRequest();
        xhr.open('GET', `http://localhost:5001/tinder-netflix/us-central1/sessionValid?id=${input_id}`, true);
        // If specified, responseType must be empty string or "text"
        // xhr.responseType = 'text';
        xhr.onload = function () {
            if (xhr.readyState === xhr.DONE) {
                if (xhr.status === 200) {
                    store.setItem('SwipeFlix_sessionId',input_id);
                    document.getElementById("loading").style.display = "none";
                    window.location.href = "http://127.0.0.1:5500/FrontEnd/session.html";
                }
                else{
                    alert("cannot Join");
                    document.getElementById("loading").style.display = "none";
                }
            }
        };

        xhr.send(null);
    }
    function createSessionPage() {
        document.getElementById("initialButtons").style.display = "none";
        document.getElementById("createSessionPage").style.display = "block";
    }

        var header = document.getElementById("multiButtonGroup");
        var btns = header.getElementsByClassName("genreButton");
        for (var i = 0; i < btns.length; i++) {
            btns[i].addEventListener("click", function() {
                // var current = document.getElementsByClassName("active");
                if(this.className.includes("active")){
                    this.className= this.className.replace(" active", "");
                }
                else{
                this.className += " active";
                console.log(this.id)    
            }
            });
        }
</script>

</html>